{% extends "base.html" %}

{% block title %}Settings{% endblock %}
{% block window_title %}Settings{% endblock %}

{% block content %}
<div class="recipe-section">
    <h3>User</h3>
    <p><strong>Name:</strong> {{ config.get('user_name', 'Not set') }}</p>
    <p class="text-muted">Onboarded: {{ config.get('onboarding_completed_at', config.get('created_at', 'Unknown'))[:10] }}</p>
</div>

<div class="recipe-section">
    <h3>Allergies</h3>
    {% set allergies = config.get('allergies', {}).get('items', []) %}
    {% if allergies %}
    <div>
        {% for item in allergies %}
        <span class="allergy-tag">{{ item }}</span>
        {% endfor %}
    </div>
    {% else %}
    <p class="text-muted">No confirmed allergies.</p>
    {% endif %}
</div>

<div class="recipe-section">
    <h3>Actions</h3>
    <div style="display: flex; flex-direction: column; gap: 10px; max-width: 300px;">
        <a href="{{ url_for('onboarding_allergies', update='true') }}" class="button">Update allergies and preferences</a>
        <a href="{{ url_for('onboarding_name') }}" class="button">Re-run full setup</a>
    </div>
</div>

<div class="nav-row">
    <a href="{{ url_for('index') }}" class="button">Back</a>
</div>
{% endblock %}
